{% extends 'base.html' %}
{% block head %}
    <title>Cart</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/admin.css') }}">
    <style>
    main .table-data .todo {
    flex-grow: 1;
    flex-basis: 50px;
    height: 640px;
    color: var(--opposite-color);
    }
    main .table-data .order {
    flex-grow: 1;
    flex-basis: 60%;
    color: var(--opposite-color);
    }
    .separator{
	margin-top: 10px;
    margin-bottom: 10px;
	height: 1px;
	width: 100%;
	background: var(--text-color);
}
    </style>
{% endblock %}
{% block content %}
    <main>
        <div class="head-title">
            <div class="left">
                <h1>Dashboard</h1>
                <ul class="breadcrumb">
                    <li>
                        <a href="{{ url_for('admin_dashboard') }}">Dashboard</a>
                    </li>
                    <li><i class='bx bx-chevron-right'></i></li>
                    <li>
                        <a class="active" href="{{ url_for('admin_dashboard') }}">Home</a>
                    </li>
                </ul>
            </div>
            <a href="#" class="btn-download">
                <i class='bx bxs-bell'></i>
                <span class="text">Notifications</span>
            </a>
        </div>

        <ul class="box-info">
                <li>
                    <i class='bx bxs-store'></i>
                    <span class="text">
                <h3>{{ item_count }}</h3>
                <p>Movies in stock</p>
            </span>
                </li>
                <li>
                    <i class='bx bxs-box'></i>
                    <span class="text">
                <h3>{{ owned }}</h3>
                <p>Movies purchased</p>
            </span>
                </li>
                <li>
                    <i class='bx bxs-dollar-circle'></i>
                    <span class="text">
                <h3> {% if not spend %} 0 {% else %}Ksh {{ spend }} {% endif %}</h3>
                <p>Total Spent</p>
            </span>
                </li>
            </ul>


        <div class="table-data">
            <div class="order" >
                <div class="head">
                    <h3>Your Cart</h3>
                </div>
                <p class="separator"></p>

            {% if items %}
                <div class="item-scroll">
                <ul style="list-style: none; ">
                    {% for item in items %}
                        {% set item_id = item[0] %}
                        <li>
                            <a href="{{ url_for('item', item_id=item[0]) }}"><p
                                    style="text-decoration: underline; color: white">{{ item[1] }}</p></a>
                            <img src="{{ item[2] }}" alt="poster" width="100" height="100">
                            <p class="description">{{ item[3] }}</p>
                            <p>price: {{ item[4] }} Ksh</p>
                            <a href="{{ item[5] }}">Watch Trailer</a>
                            <form method="POST" action="{{ url_for('remove_from_cart', item_id=item_id) }}">

                                <button type="submit">Remove from Cart</button>
                            </form>
                        </li>
                        <p class="separator"></p>
                    {% endfor %}
                </ul>
                </div>

                <br>
                {% else %}
                    <p class="empty">Your cart is empty.</p>
            {% endif %}
            </div>
            <div class="todo">
                <div class="head">
                    <h3>Checkout</h3>
                </div>
                <form method="POST" action="{{ url_for('checkout') }}" style="margin: 0 auto" class="check-out">
                    <button type="submit">Checkout</button>
                    {{ total }} Ksh
                </form>
            </div>
        </div>
    </main>

{% endblock %}
